# Whitelist approach: ignore everything, then allow only what Docker builds need
# This reduces build context from ~900MB to just what's required

# Ignore everything first
*

# === n8n main image (docker/images/n8n/Dockerfile) ===
!compiled
!compiled/**
!THIRD_PARTY_LICENSES.md

# === runners image (docker/images/runners/Dockerfile + Dockerfile.distroless) ===
!dist
!dist/task-runner-javascript
!dist/task-runner-javascript/**
!packages
!packages/@n8n
!packages/@n8n/task-runner-python
!packages/@n8n/task-runner-python/**

# === Docker build files (entrypoints, configs) ===
!docker
!docker/images
!docker/images/n8n
!docker/images/n8n/docker-entrypoint.sh
!docker/images/runners
!docker/images/runners/n8n-task-runners.json

# === Development Dockerfile (root Dockerfile) ===
# Allow root files needed for development build
!package.json
!pnpm-lock.yaml
!pnpm-workspace.yaml
!tsconfig.json
!turbo.json
!patches
!patches/**
!scripts
!scripts/**
!Dockerfile
!docker-compose.yml

# Allow packages but exclude node_modules (pnpm uses symlinks which cause Docker issues)
!packages
!packages/**
# Exclude node_modules from packages (must come after !packages/**)
packages/**/node_modules
packages/@n8n/**/node_modules
packages/frontend/**/node_modules
packages/extensions/**/node_modules
packages/testing/**/node_modules
node_modules

# Exclude build artifacts
**/dist
**/.turbo
**/.build
**/compiled

# Exclude git and other unnecessary files
.git
.gitignore
*.log
.DS_Store